<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rank Grass</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 40px;
      background: #e4ffe4;
    }
    h1 {
      font-size: 2.5em;
      color: #2e8b57;
    }
    button {
      margin: 5px;
      padding: 14px 20px;
      font-size: 1.2em;
      border: none;
      background: #2e8b57;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background: #1f6a45;
    }
    #average {
      font-size: 2em;
      margin-top: 20px;
    }
    a {
      display: block;
      margin-top: 30px;
      color: #2e8b57;
      text-decoration: none;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>üå± Rank Grass</h1>
  <p>Pick a number from 1 to 10 to rate grass!</p>

  <div id="buttons"></div>
  <div id="average">Average Rating: ...</div>
  <a href="index.html">‚Üê Back to Home</a>

  <!-- Firebase -->
  <script type="module">
    // 1. Import Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getDatabase, ref, get, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

    // 2. Your Firebase config (replace with your actual config)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const ratingRef = ref(db, "grassRatings");

    // 3. Show 1‚Äì10 buttons
    const buttons = document.getElementById("buttons");
    for (let i = 1; i <= 10; i++) {
      const btn = document.createElement("button");
      btn.textContent = i;
      btn.onclick = () => rateGrass(i);
      buttons.appendChild(btn);
    }

    // 4. Save rating (only once per browser using localStorage)
    async function rateGrass(score) {
      if (localStorage.getItem("ratedGrass")) {
        alert("You already ranked grass!");
        return;
      }

      const snapshot = await get(ratingRef);
      let data = snapshot.exists() ? snapshot.val() : { total: 0, count: 0 };

      data.total += score;
      data.count += 1;
      await set(ratingRef, data);

      localStorage.setItem("ratedGrass", "true");
      alert("Thanks for rating grass!");
    }

    // 5. Live average update
    onValue(ratingRef, (snapshot) => {
      const data = snapshot.val();
      const average = data && data.count > 0 ? (data.total / data.count).toFixed(2) : "N/A";
      document.getElementById("average").textContent = `Average Rating: ${average}`;
    });
  </script>

</body>
</html>
